<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Recommendation</title>
</head>
<body>
    <h1>Enter Your Recipe</h1>
    <form id="recipeForm">
        <textarea id="recipeText" placeholder="Enter your recipe here" rows="10" cols="30"></textarea><br><br>
        <button type="submit">Get Restaurant Recommendations</button>
    </form>

    <div id="recommendations"></div>
    <div id="map" style="width: 100%; height: 400px; margin-top: 20px; display: none;"></div>

    <script>
        document.getElementById("recipeForm").addEventListener("submit", async function(event) {
            event.preventDefault();  // Prevent form from submitting the usual way

            const recipeText = document.getElementById("recipeText").value;

            // Send the recipe data to the server
            try {
                const response = await fetch('http://localhost:3000/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ recipeText }),
                });

                if (response.ok) {
                    const data = await response.json();
                    displayRecommendations(data.recommendations);
                } else {
                    const errorText = await response.text();
                    alert(`Error: ${errorText}`);
                }
            } catch (error) {
                console.error("Error:", error);
                alert("An error occurred while fetching recommendations.");
            }
        });

        function displayRecommendations(recommendations) {
            const recommendationsDiv = document.getElementById("recommendations");
            const mapDiv = document.getElementById("map");
            recommendationsDiv.innerHTML = ''; // Clear previous recommendations
            mapDiv.style.display = "none";

            if (recommendations && recommendations.length > 0) {
                const list = document.createElement('ul');
                recommendations.forEach(rec => {
                    const listItem = document.createElement('li');
                    listItem.innerHTML = `<strong>${rec.name}</strong><br>
                                          Cuisine: ${rec.cuisine}<br>
                                          Address: ${rec.address}<br>
                                          Rating: ${rec.rating}`;
                    list.appendChild(listItem);
                });
                recommendationsDiv.appendChild(list);
            } else {
                recommendationsDiv.innerHTML = 'No restaurant recommendations found.';
            }
        }

        function showMap(address) {
            const mapDiv = document.getElementByID('map');
            const encodedAddress = encodeURIComponent(address);
            const googleMapsEmbedUrl = `https://www.google.com/maps/embed/v1/place?key=YOUR_GOOGLE_MAPS_API_KEY&q=${encodedAddress}`;

            mapDiv.innerHTML = `<iframe 
                                  width="100%" 
                                  height="100%" 
                                  frameborder="0" 
                                  style="border:0;" 
                                  src="${googleMapsEmbedUrl}" 
                                  allowfullscreen>
                                </iframe>`;
            mapDiv.style.display = "block"; // Show the map
         }
    </script>
</body>
</html>
